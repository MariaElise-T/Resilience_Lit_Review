To overcome the shortage that the particle swarm optimization is prone to trap into local extremum searching for the lost in population diversity, a strategy in which the velocity is not dependent on the size of distance between the individual and the optimal particle but only dependent on its direction is proposed. The average similarity of particles in the population is seem as the measure of population diversity and it is used to balance the global and local searching of the algorithm. Based on establishing the relationship between inertia weight and the measure of population diversity which has been inserted into the algorithm, A resilient particle swarm optimization algorithm with dynamically changing inertia weight (ARPSO) was proposed. ARPSO was applied in simulation experiment. The results show that the algorithm has the ability to avoid being trapped in local extremum and advance the probability of finding global optimum.