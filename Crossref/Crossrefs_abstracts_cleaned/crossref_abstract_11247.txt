In recent years, extreme natural disasters have occurred frequently, causing a huge impact on the power grid. In this paper, the method of purchasing and deployment of resources of the distribution network is studied to improve the resilience of the system from the perspective of pre-disaster defense. Considering the sequential game relationship among resource providers, utilities, and extreme disasters, this paper establishes a multi-stage extensive-form game model. To realize collaborative pre- and post-disaster defense of the system, this model comprehensively considers pre-disaster resource deployment, post-disaster reconfiguration and repair crew dispatch. The efficient deriving method of non-inferior solution is designed stage by stage, and the backward induction method is adopted to solve the overall game model efficiently. The experimental results under multiple failure scenarios show the proposed method can give a near-optimal pre-disaster resources purchase and deployment plan that takes into account the characteristics of post-disaster recovery, effectively reducing the expected power loss of the distribution system.