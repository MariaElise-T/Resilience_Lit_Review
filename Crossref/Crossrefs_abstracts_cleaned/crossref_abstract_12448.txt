Microbial communities display remarkable diversity, facilitated by the secretion of chemicals that can create new niches. However, it is unclear why cells often secrete even essential metabolites after evolution. Based on theoretical results indicating that cells can enhance their own growth rate by leaking even essential metabolites, we show that such “leaker” cells can establish an asymmetric form of mutualism with “consumer” cells that consume the leaked chemicals: the consumer cells benefit from the uptake of the secreted metabolites, while the leaker cells also benefit from such consumption, as it reduces the metabolite accumulation in the environment and thereby enables further secretion, resulting in frequency-dependent coexistence of multiple microbial species. As supported by extensive simulations, such symbiotic relationships generally evolve when each species has a complex reaction network and adapts its leakiness to optimize its own growth rate under crowded conditions and nutrient limitations. Accordingly, symbiotic ecosystems with diverse cell species that leak and exchange many metabolites with each other are shaped by cell-level adaptation of leakiness of metabolites. Moreover, the resultant ecosystems with entangled metabolite exchange are resilient against structural and environmental perturbations. Thus, we present a theory for the origin of resilient ecosystems with diverse microbes mediated by secretion and exchange of essential chemicals.